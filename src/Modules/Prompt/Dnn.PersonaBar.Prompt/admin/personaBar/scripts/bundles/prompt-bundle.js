!function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/scripts/",t(t.s=3)}([function(e,t,n){"use strict";var r,o,i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(l){var s=!1;if(r=l,o="function"==typeof r?r.call(t,n,t,e):r,!(void 0!==o&&(e.exports=o)),s=!0,"object"===i(t)&&(e.exports=l(),s=!0),!s){var a=window.Cookies,u=window.Cookies=l();u.noConflict=function(){return window.Cookies=a,u}}}(function(){function e(){for(var e=0,t={};e<arguments.length;e++){var n=arguments[e];for(var r in n)t[r]=n[r]}return t}function t(n){function r(t,o,i){var l;if("undefined"!=typeof document){if(arguments.length>1){if(i=e({path:"/"},r.defaults,i),"number"==typeof i.expires){var s=new Date;s.setMilliseconds(s.getMilliseconds()+864e5*i.expires),i.expires=s}i.expires=i.expires?i.expires.toUTCString():"";try{l=JSON.stringify(o),/^[\{\[]/.test(l)&&(o=l)}catch(e){}o=n.write?n.write(o,t):encodeURIComponent(String(o)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)),t=t.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),t=t.replace(/[\(\)]/g,escape);var a="";for(var u in i)i[u]&&(a+="; "+u,i[u]!==!0&&(a+="="+i[u]));return document.cookie=t+"="+o+a}t||(l={});for(var c=document.cookie?document.cookie.split("; "):[],d=/(%[0-9A-Z]{2})+/g,p=0;p<c.length;p++){var f=c[p].split("="),h=f.slice(1).join("=");'"'===h.charAt(0)&&(h=h.slice(1,-1));try{var m=f[0].replace(d,decodeURIComponent);if(h=n.read?n.read(h,m):n(h,m)||h.replace(d,decodeURIComponent),this.json)try{h=JSON.parse(h)}catch(e){}if(t===m){l=h;break}t||(l[m]=h)}catch(e){}}return l}}return r.set=r,r.get=function(e){return r.call(r,e)},r.getJSON=function(){return r.apply({json:!0},[].slice.call(arguments))},r.defaults={},r.remove=function(t,n){r(t,"",e(n,{expires:-1}))},r.withConverter=t,r}return t(function(){})})},function(e,t){},function(e,t){e.exports=jQuery},function(e,t,n){"use strict";(function(e){function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=(n(1),n(0)),i=function(){function n(e,r,o,i){t(this,n);var l=this;l.version=e,l.util=o,l.wrapper=r,console.log(l.util),l.params=i,l.tabId=null,l.history=[],sessionStorage&&sessionStorage.getItem("dnn-prompt-console-history")&&(l.history=JSON.parse(sessionStorage.getItem("dnn-prompt-console-history"))),l.cmdOffset=0,l.createElements(),l.wireEvents(),l.showGreeting(),l.busy(!1),l.focus(),l.getCommands()}return r(n,[{key:"wireEvents",value:function(){var e=this;e.keyDownHandler=function(t){e.onKeyDown(t)},e.clickHandler=function(t){e.onClickHandler(t)},window.parent.document.addEventListener("keydown",e.keyDownHandler),document.addEventListener("keydown",e.keyDownHandler),e.ctrlEl.addEventListener("click",e.clickHandler)}},{key:"onClickHandler",value:function(e){e.target.classList.contains("dnn-prompt-cmd-insert")?(this.inputEl.value=e.target.dataset.cmd.replace(/'/g,'"'),this.inputEl.focus()):this.focus()}},{key:"onKeyDown",value:function(e){var t=this;if(e.ctrlKey&&192===e.keyCode)return void(t.wrapper[0].offsetLeft<=0?t.util.loadPanel("Dnn.Prompt",{moduleName:"Dnn.Prompt",folderName:"",identifier:"Dnn.Prompt",path:"Prompt"}):t.util.closePersonaBar());if(!t.isBusy&&t.inputEl===document.activeElement)switch(e.keyCode){case 13:return t.runCmd();case 38:t.history.length+t.cmdOffset>0&&(t.cmdOffset--,t.inputEl.value=t.history[t.history.length+t.cmdOffset],e.preventDefault());break;case 40:t.cmdOffset<-1&&(t.cmdOffset++,t.inputEl.value=t.history[t.history.length+t.cmdOffset],e.preventDefault())}}},{key:"runCmd",value:function(){var e=this,t=this,n=t.inputEl.value.trim();if(t.tabId||(t.tabId=dnn.getVar("sf_tabId")),t.cmdOffset=0,t.inputEl.value="",t.writeLine(n,"cmd"),""!==n){t.history.push(n),sessionStorage&&sessionStorage.setItem("dnn-prompt-console-history",JSON.stringify(t.history));var r=n.split(" "),o=r[0].toUpperCase();return"CLS"===o||"CLEAR-SCREEN"===o?void(t.outputEl.innerHTML=""):"EXIT"===o?void this.util.closePersonaBar():"HELP"===o?void t.renderHelp(r):"CONFIG"===o?void t.configConsole(r):"CLH"===o||"CLEAR-HISTORY"===o?(t.history=[],sessionStorage.removeItem("dnn-prompt-console-history"),void t.writeLine("Session command history cleared")):"SET-MODE"===o?void t.changeUserMode(r):void("RELOAD"===o?window.top.location.reload(!0):!function(){t.busy(!0);var r=!1;"GOTO"===o&&(r=!0);var i=e.util.sf.antiForgeryToken,l="API/PersonaBar/Command/Cmd";l=e.util.sf?e.util.sf.getSiteRoot()+l:"/"+l,fetch(l,{method:"post",headers:new Headers({"Content-Type":"application/json",RequestVerificationToken:i}),credentials:"include",body:JSON.stringify({cmdLine:n,currentPage:t.tabId})}).then(function(e){return e.json()}).then(function(e){e.Message&&(e.output=e.Message,e.isError=!0);var n=e.output,o=e.isError?"error":"ok",i=e.data;console.log("runCmd::result.fieldOrder",e.fieldOrder),console.log("runCmd::(result.fieldOrder",e.fieldOrder);var l=e.fieldOrder;if("undefined"!=typeof l&&l&&0!==l.length||(l=null),r)window.location.href=n;else if(i){var s=t.renderData(i,l);t.writeHtml(s),n&&t.writeLine(n)}else e.isHtml?t.writeHtml(n):t.writeLine(n,o);e.mustReload&&(t.writeHtml('<div class="dnn-prompt-ok"><strong>Reloading in 3 seconds</strong></div>'),setTimeout(function(){return location.reload(!0)},3e3))}).catch(function(){t.writeLine("Error sending request to server","error")}).then(function(){t.busy(!1),t.focus()}),t.inputEl.blur()}())}}},{key:"getCommands",value:function(){var e=this,t="API/PersonaBar/Command/List";t=this.util.sf?this.util.sf.getSiteRoot()+t:"/"+t,fetch(t,{method:"get",credentials:"include"}).then(function(e){return e.json()}).then(function(t){e.commands=t})}},{key:"focus",value:function(){this.inputEl.focus()}},{key:"scrollToBottom",value:function(){this.ctrlEl.scrollTop=this.ctrlEl.scrollHeight}},{key:"newLine",value:function(){this.outputEl.appendChild(document.createElement("br")),this.scrollToBottom()}},{key:"writeLine",value:function(e,t){var n=document.createElement("span");t=t||"ok",n.className="dnn-prompt-"+t,n.innerText=e,this.outputEl.appendChild(n),this.newLine()}},{key:"writeHtml",value:function(e){var t=document.createElement("div");t.innerHTML=e,this.outputEl.appendChild(t),this.newLine()}},{key:"renderData",value:function(e,t){return console.log("renderData::fieldOrder",t),e.length>1?this.renderTable(e,t):1==e.length?this.renderObject(e[0],t):""}},{key:"renderTable",value:function(e,t){if(console.log("renderTable::fieldOrder",t),e&&e.length){var n=(this.extractLinkFields(e[0]),t);if(!n||!n.length){console.log("columns",n),n=[];var r=e[0];for(var o in r)o.startsWith("__")||n.push(o)}var i='<table class="dnn-prompt-tbl"><thead><tr>';for(var l in n)i+="<th>"+n[l]+"</th>";i+="</tr></thead><tbody>";for(var s=0;s<e.length;s++){var a=e[s];i+="<tr>";for(var u in n){var c=n[u],d=a[c]?a[c]:"",p=a["__"+c]?a["__"+c]:null;i+=p?'<td><a href="#" class="dnn-prompt-cmd-insert" data-cmd="'+p+'" title="'+p.replace(/'/g,"&quot;")+'">'+d+"</a></td>":"<td> "+d+"</td>"}i+="</tr>"}return i+="</tbody></table>"}}},{key:"renderObject",value:function(e,t){var n=this.extractLinkFields(e),r='<table class="dnn-prompt-tbl">';for(var o in e)o.startsWith("__")?r+='<tr><td class="dnn-prompt-lbl">'+o.slice(2)+'</td><td>:</td><td><a href="#" class="dnn-prompt-cmd-insert" data-cmd="'+e[o]+'" title="'+e[o].replace(/'/g,"&quot;")+'">'+e[o.slice(2)]+"</a></td></tr>":n.indexOf(o)===-1&&(r+='<tr><td class="dnn-prompt-lbl">'+o+"</td><td>:</td><td>"+e[o]+"</td></tr>");return r+="</table>"}},{key:"renderHelp",value:function(e){var t=this,n="DesktopModules/Admin/Dnn.PersonaBar/Modules/Dnn.Prompt/help/";n+=e&&1!=e.length?e[1]+".html":"index.html",n=this.util.sf?this.util.sf.getSiteRoot()+n:"/"+n,t.busy(!0),fetch(n,{method:"get",headers:new Headers({"Content-Type":"text/html"}),credentials:"include"}).then(function(e){return 200==e.status?e.text():'<div class="dnn-prompt-error">Unable to find help for that command</div>'}).then(function(e){t.writeHtml(e)}).catch(function(){t.writeLine("Error sending request to server","error")}).then(function(){t.busy(!1),t.focus()})}},{key:"showGreeting",value:function(){this.writeLine("Prompt ["+this.version+"] Type 'help' to get a list of commands","cmd"),this.newLine()}},{key:"extractLinkFields",value:function(e){var t=[];if(!e||!e.length)return t;for(var n in e)n.startsWith("__")&&t.push(n.slice(2));return t}},{key:"createElements",value:function(){var e=this,t=document;e.ctrlEl=t.getElementById("prompt"),e.outputEl=t.createElement("div"),e.inputElWrapper=t.createElement("div"),e.inputEl=t.createElement("input"),e.busyEl=t.createElement("div"),e.ctrlEl.className="dnn-prompt",e.outputEl.className="dnn-prompt-output",e.inputElWrapper.className="dnn-prompt-input-wrapper",e.inputEl.className="dnn-prompt-input",e.busyEl.className="dnn-prompt-busy",e.inputEl.setAttribute("spellcheck","false"),e.ctrlEl.appendChild(e.outputEl),e.inputElWrapper.appendChild(e.inputEl),e.ctrlEl.appendChild(e.inputElWrapper),e.ctrlEl.appendChild(e.busyEl),e.ctrlEl.style.display="block";var n=o.get("dnn-prompt-console-height");n&&e.configConsole(["config",n])}},{key:"busy",value:function(e){this.isBusy=e,this.busyEl.style.display=e?"block":"none",this.inputEl.style.display=e?"none":"inline-block"}},{key:"isFlag",value:function(e){return e&&e.startsWith("--")}},{key:"getFlag",value:function(e,t){var n=null;if(!t||t.length)return null;for(var r=1;r<t.length;r++)if(n=t[r],this.isFlag(n)&&n.toUpperCase()===e.toUpperCase())return r+1<t.length?this.isFlag(t[r+1])?null:t[r+1]:null;return null}},{key:"hasFlag",value:function(e,t){if(!t||t.length)return!1;for(var n=0;n<t.length;n++)if(t[n].toUpperCase===e.toUpperCase())return!0;return!1}},{key:"configConsole",value:function(e){var t=null;this.hasFlag("--height")?t=this.getFlag("--height",e):this.isFlag(e[1])||(t=e[1]),t&&(this.ctrlEl.style.height=t,o.set("dnn-prompt-console-height",t))}},{key:"changeUserMode",value:function(t){if(t||!(t.length>=2)){var n=null;if(this.hasFlag("--mode")?n=this.getFlag("--mode",t):this.isFlag(t[1])||(n=t[1]),n){var r=dnn.controlBar.getService(),o=dnn.controlBar.getServiceUrl(r);e.ajax({url:o+"ToggleUserMode",type:"POST",data:{UserMode:n},beforeSend:r.setModuleHeaders,success:function(){window.location.href=window.location.href},error:function(e){dnn.controlBar.responseError(e)}})}}}}]),n}();window.DnnPrompt=i}).call(t,n(2))}]);